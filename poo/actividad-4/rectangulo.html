<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Canvas Rectángulo</title>
    <style>
        body 
        {
            width: 38%;
            height: 38%;
            border: 2px solid black;
        }
    </style>
</head>
<body>
<script>

let canvas = document.createElement('canvas');
canvas.width = 400;
canvas.height = 400;
document.body.appendChild(canvas);

let ctx = canvas.getContext('2d');

let rect = 
{
    x: 200,
    y: 200,
    width: 100,
    height: 50,
    angle: 0
};

class Rectangle {
    constructor(x,y,width, height, angle = 0) {
        this.x=x;
        this.y = y;
        this.width = width;
        this.height = height;
        this.angle = angle;
        this.speed = 6; 
    }

    draw() {
        ctx.save();
        ctx.translate(this.x, this.y);
        ctx.rotate(this.angle);
        ctx.fillStyle = 'blue';
        ctx.fillRect(-this.width / 2, -this.height / 2, this.width, this.height);
        ctx.restore();
    }

    rotate(radians) {
        this.angle += radians;
    }

    moveForward() {
        this.x += this.speed * Math.cos(this.angle);
        this.y += this.speed * Math.sin(this.angle);
    }

    moveBackward() {
        this.x -= this.speed * Math.cos(this.angle);
        this.y -= this.speed * Math.sin(this.angle);
    }
}

function clearCanvas()
{
    ctx.clearRect(0, 0, canvas.width, canvas.height);
}

class RectangleController {
    constructor(rectangle){
    this.rectangle=rectangle;

    window.addEventListener('keydown', (event) => this.KeyHandler(event));
    }

    KeyHandler(event) {
        switch (event.key) {

            case "ArrowUp" :
                this.rectangle.moveForward();
                break;
            case "ArrowDown":
                this.rectangle.moveBackward();
                break;
            case "ArrowLeft":
                this.rectangle.rotate(-0.1); // rotación antihoraria
                break;
            case "ArrowRight":
                this.rectangle.rotate(0.1);  // rotación horaria
                break;
        } 

        draw(); // Actualiza canvas cvez que se presiona
   
        }

}

function draw(){
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    rectangle.draw();
}

//intanciacion
let rectangle= new Rectangle (200,200,100,50);
let controller= new RectangleController (rectangle)

function main()
{
    draw();
    setInterval( update, 16 );
}

window.onload = main;

</script>
</body>
</html>